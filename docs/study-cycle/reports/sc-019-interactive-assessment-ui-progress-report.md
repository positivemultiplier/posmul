---\ntype: how-to-guide\ndomain: "study-cycle"\nstatus: "in-progress"\nlast_updated: "2025-06-28"\nauthor: "AI Assistant"\n---\n\n# 📖 [SC-019] 중간 보고서: 답안 제출 API 사용 가이드\n\n## 📚 목차\n\n- [📖 [SC-019] 중간 보고서: 답안 제출 API 사용 가이드](#-sc-019-중간-보고서-답안-제출-api-사용-가이드)\n  - [📚 목차](#-목차)\n  - [🎯 1. 개요](#-1-개요)\n  - [🚀 2. 핵심 구현 내용 (백엔드)](#-2-핵심-구현-내용-백엔드)\n  - [⚙️ 3. API 사용 방법](#️-3-api-사용-방법)\n  - [⚠️ 4. 프론트엔드 개발 현황 및 문제점](#️-4-프론트엔드-개발-현황-및-문제점)\n  - [💡 5. 다음 단계](#-5-다음-단계)\n\n## 🎯 1. 개요\n\n이 문서는 **[SC-019] 문제 풀이 인터페이스** 작업의 중간 진행 상황을 보고하고, 백엔드에 구현된 **답안 제출 및 자동 채점 API**의 사용법을 안내하는 How-to 가이드입니다.\n\n프론트엔드 개발 중 Linter/TypeScript 경로 해석 문제라는 환경적 이슈에 직면하여, 우선 백엔드 로직 구현을 완료했습니다. 이 가이드를 통해 프론트엔드 팀은 UI 개발 재개 시 백엔드 API를 원활하게 연동할 수 있습니다.\n\n```mermaid\ngraph TD\n    A["SC-019 Task Start"] --> B{UI or Backend?}\n    B --> C["UI Dev Blocked<br/>(Linter/TS Path Issue)"]\n    B --> D["Backend API Dev<br/>(Submission Logic)"]\n    D --> E["✅ UseCase & DTOs Implemented"]\n    E --> F["✅ Entity Logic Updated"]\n    F --> G["📝 API How-to Guide<br/>(This Document)"]\n    C --> H["⏳ Waiting for Env Fix"]\n    G --> H\n    H --> I["UI Dev Resume"]\n    I --> J["🚀 SC-019 Task Complete"]\n```\n\n## 🚀 2. 핵심 구현 내용 (백엔드)\n\n답안 제출 및 채점 로직의 핵심은 `SubmitAssessmentUseCase`에 구현되었습니다. 전체 흐름은 아래와 같습니다.\n\n```mermaid\nsequenceDiagram\n    participant Client as Frontend\n    participant API_Route as /api/assessment/{id}/submit\n    participant UseCase as SubmitAssessmentUseCase\n    participant Repository as IAssessmentRepository\n    participant Domain as Assessment/Submission\n\n    Client->>API_Route: POST (SubmitAssessmentDto)\n    API_Route->>UseCase: execute(dto)\n    UseCase->>Repository: findById(assessmentId)\n    Repository-->>UseCase: Assessment (with answers)\n    UseCase->>Domain: Grade answers & create Submission\n    Domain-->>UseCase: Submission Entity\n    UseCase->>Repository: saveSubmission(submission)\n    Repository-->>UseCase: Success/Failure\n    UseCase-->>API_Route: SubmissionResultDto\n    API_Route-->>Client: JSON Response\n```\n\n- **도메인 (`assessment.entity.ts`)**: `Submission` 엔티티를 채점 완료 후의 상태를 저장하도록 리팩토링했습니다.\n- **DTOs**: `SubmitAssessmentDto`와 `SubmissionResultDto`를 통해 애플리케이션 계층의 데이터 입출력을 명확히 정의했습니다.\n- **UseCase (`submit-assessment.use-case.ts`)**: 채점, 엔티티 생성, 저장 등 모든 비즈니스 로직을 오케스트레이션합니다.\n\n## ⚙️ 3. API 사용 방법\n\n### 엔드포인트\n\n- **Method**: `POST`\n- **URL**: `/api/assessment/{assessmentId}/submit`\n\n### 요청 본문 (Request Body)\n\n`SubmitAssessmentDto` 인터페이스를 따르는 JSON 객체를 전송해야 합니다.\n\n```typescript\n// src/bounded-contexts/assessment/application/dto/submit-assessment.dto.ts\n\nexport interface AnswerDto {\n  questionId: QuestionId;\n  value: string | string[]; // For multiple choice, could be an array of option IDs\n}\n\nexport interface SubmitAssessmentDto {\n  assessmentId: AssessmentId;\n  userId: UserId;\n  answers: AnswerDto[];\n}\n```\n\n**요청 예시:**\n\n```json\n{\n  "assessmentId": "a9e6c1a8-1b2c-4d3e-8f9a-0b1c2d3e4f5a",\n  "userId": "user-12345",\n  "answers": [\n    { "questionId": "q-1", "value": "opt-c" },\n    { "questionId": "q-2", "value": ["opt-a", "opt-d"] },\n    { "questionId": "q-3", "value": "Coroutine" }\n  ]\n}\n```\n\n### 응답 (Response)\n\n성공 시, `SubmissionResultDto` 형태의 JSON 객체와 `200 OK` 상태 코드를 반환합니다.\n\n```typescript\n// src/bounded-contexts/assessment/application/dto/submission-result.dto.ts\n\nexport interface GradedAnswer {\n  questionId: QuestionId;\n  isCorrect: boolean;\n  score: number;\n  userAnswer?: string | string[];\n  correctAnswer?: string | string[];\n}\n\nexport interface SubmissionResultDto {\n  submissionId: SubmissionId;\n  assessmentId: AssessmentId;\n  studentId: UserId;\n  finalScore: number;\n  totalPoints: number;\n  correctCount: number;\n  totalQuestions: number;\n  gradedAnswers: GradedAnswer[];\n}\n```\n\n**성공 응답 예시 (200 OK):**\n```json\n{\n  "submissionId": "sub-9876",\n  "assessmentId": "a9e6c1a8-1b2c-4d3e-8f9a-0b1c2d3e4f5a",\n  "studentId": "user-12345",\n  "finalScore": 80,\n  "totalPoints": 100,\n  "correctCount": 8,\n  "totalQuestions": 10,\n  "gradedAnswers": [\n    { "questionId": "q-1", "isCorrect": true, "score": 10, "userAnswer": "opt-c", "correctAnswer": "opt-c" },\n    { "questionId": "q-2", "isCorrect": false, "score": 0, "userAnswer": "opt-a", "correctAnswer": "opt-b" }\n  ]\n}\n```\n\n실패 시에는 에러 메시지를 담은 JSON 객체와 적절한 HTTP 상태 코드(404, 500 등)를 반환합니다.\n\n## ⚠️ 4. 프론트엔드 개발 현황 및 문제점\n\n- **현황**: 문제 풀이 페이지(`/assessment/[assessmentId]/solve`)의 기본 구조와 데이터 조회 로직(`page.tsx`) 작성을 시도했습니다.\n- **문제점**: Linter 및 TypeScript 컴파일러가 `tsconfig.json`에 정의된 `@/*` 경로 alias를 포함하여 `react` 같은 기본 모듈조차 해석하지 못하는 심각한 환경 문제가 발생했습니다. 상대 경로로 변환해도 문제가 해결되지 않았습니다.\n\n```mermaid\ngraph LR\n    A[page.tsx] -->|imports| B(React)\n    A -->|imports| C(@/shared/...)\n    B -- X --> D{Error: Cannot find module}\n    C -- X --> D\n```\n\n이 문제는 개별 파일 수정으로 해결이 불가능하며, `npm install` 재실행, IDE 재시작, `node_modules` 및 `.next` 디렉토리 삭제 후 재설치 등 환경 초기화 조치가 필요할 것으로 보입니다.\n\n## 💡 5. 다음 단계\n\n1.  **환경 문제 해결**: 개발 환경 전문가가 Linter/TypeScript 경로 해석 문제를 해결합니다.\n2.  **UI 개발 재개**: 환경 문제가 해결되면, 본 가이드에 따라 백엔드 API와 연동하여 프론트엔드 UI 개발을 재개합니다.\n3.  **API Route 구현**: 답안 제출 UseCase를 실제로 호출하는 API Route(`src/app/api/assessment/[assessmentId]/submit/route.ts`)를 구현합니다. (백엔드 로직은 완성되었으나, API 엔드포인트 파일 생성은 UI와 함께 진행 예정)\n4.  **최종 통합 및 테스트**: UI와 API를 통합하고 E2E 테스트를 진행하여 **[SC-019]** 작업을 최종 완료합니다.\n 